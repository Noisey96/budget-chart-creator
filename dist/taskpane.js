!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(r=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}return n}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t,n,r,a,o,s){try{var i=e[o](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var s=e.apply(t,r);function i(e){n(s,a,o,i,c,"next",e)}function c(e){n(s,a,o,i,c,"throw",e)}i(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.Excel&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("select-month").onchange=l,document.getElementById("add-update-chart").onclick=d,document.getElementById("refresh-charts").onclick=g,document.getElementById("edit-item-category-list").onclick=j)}));var a,o,s,i,c=0,u={active:["Charity & Gifts","Cleaning Products & Services","Clothing","Electronics & Software","Entertainment","Food","Furniture & Home Accessories","Housing","Insurance & Loan Payments","Kitchen & Dining","Medical Products & Services","Work Supplies","Other"],inactive:[]};function l(){return f.apply(this,arguments)}function f(){return f=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,o,s,i,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.getElementById("select-month"),a=n.options[n.selectedIndex].value,(r=t.workbook.worksheets.getActiveWorksheet()).charts.load("count"),e.next=6,t.sync();case 6:o=r.charts.count,s=0;case 8:if(!(s<o)){e.next=25;break}return(i=r.charts.getItemAt(s)).load("name"),c=i.title.load("text"),e.next=14,t.sync();case 14:return(u=i.name.split("_"))[1]=a,i.name=u.join("_"),(l=c.text.split(" "))[l.length-1]=a,c.text=l.join(" "),e.next=22,t.sync();case 22:s++,e.next=8;break;case 25:return e.next=27,g();case 27:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(A);case 2:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}var m=null;function d(){Office.context.ui.displayDialogAsync("https://localhost:3000/chart.html",{height:45,width:55},(function(e){(m=e.value).addEventHandler(Office.EventType.DialogMessageReceived,h)}))}function h(e){return p.apply(this,arguments)}function p(){return p=r(regeneratorRuntime.mark((function t(n){var o,s,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.message.split("_")[0],s=C(o),i=Number(n.message.split("_")[1]),m.close(),t.next=6,Excel.run(function(){var t=r(regeneratorRuntime.mark((function t(n){var r,u,l,f,m,d,h,p,g,y,v,k;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(n);case 2:if(r=b(s,i),u=e(r,3),l=u[0],f=u[1],m=u[2],d=n.workbook.worksheets.getActiveWorksheet(),c){t.next=16;break}return d.charts.onAdded.add(x),d.charts.onDeleted.add(x),h=n.workbook.worksheets.add("Tables"),d.load("position"),h.load("position"),t.next=12,n.sync();case 12:return h.position=d.position+1,h.visibility=Excel.SheetVisibility.hidden,t.next=16,n.sync();case 16:return h=n.workbook.worksheets.getItem("Tables"),p=h.tables.getItemOrNullObject(s+"_"+a),t.next=20,n.sync();case 20:if(p.isNullObject){t.next=34;break}return p.getDataBodyRange().values=[[l,f]],h.getUsedRange().format.autofitColumns(),h.getUsedRange().format.autofitRows(),t.next=27,n.sync();case 27:return g=d.charts.getItem(s+"_"+a),t.next=30,O(n,g,i,l,m);case 30:return t.next=32,n.sync();case 32:t.next=52;break;case 34:return h=n.workbook.worksheets.getItem("Tables"),y=h.getRange("A"+(3*c+1)+":B"+(3*c+2)),(v=h.tables.add(y,!0)).name=s+"_"+a,v.getHeaderRowRange().values=[["Spent","Unspent"]],v.getDataBodyRange().values=[[l,f]],h.getUsedRange().format.autofitColumns(),h.getUsedRange().format.autofitRows(),t.next=44,n.sync();case 44:return k=d.charts.add("BarStacked",y,"Columns"),t.next=47,E(n,k,o,s);case 47:return t.next=49,O(n,k,i,l,m);case 49:return t.next=51,n.sync();case 51:c++;case 52:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(A);case 6:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function g(){return y.apply(this,arguments)}function y(){return y=r(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Excel.run(function(){var t=r(regeneratorRuntime.mark((function t(n){var r,o,s,i,c,u,l,f,m,d,h,p,g,y,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.workbook.worksheets.getItemOrNullObject("Tables"),t.next=3,n.sync();case 3:if(r.isNullObject){t.next=33;break}return t.next=6,w(n);case 6:return r.tables.load("count"),t.next=9,n.sync();case 9:o=r.tables.count,s=0;case 11:if(!(s<o)){t.next=33;break}return(i=r.tables.getItemAt(s)).load("name"),t.next=16,n.sync();case 16:return c=i.name.split("_")[0],u=i.getDataBodyRange().load("values"),t.next=20,n.sync();case 20:return l=u.values,f=l[0][0]+l[0][1],m=b(c,f),d=e(m,3),h=d[0],p=d[1],g=d[2],u.values=[[h,p]],t.next=26,n.sync();case 26:return y=n.workbook.worksheets.getActiveWorksheet(),x=y.charts.getItem(c+"_"+a),t.next=30,O(n,x,f,h,g);case 30:s++,t.next=11;break;case 33:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch(A);case 2:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function x(){return v.apply(this,arguments)}function v(){return v=r(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=r(regeneratorRuntime.mark((function e(t){var n,r,a,o,s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.worksheets.getActiveWorksheet()).charts.load("items"),e.next=4,t.sync();case 4:for(r=n.charts.items,a=0;a<r.length;a++)o=r[a],s=Math.floor(a/3),i=a%3,o.left=10+380*i,o.top=10+175*s;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch(A);case 2:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=r(regeneratorRuntime.mark((function e(t){var n,r,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(new Date).getFullYear(),r=a+" "+n,i=t.workbook.worksheets.getItem(r),c=i.tables.getItem(a),o=c.columns.getItem("Item Category").getDataBodyRange().load("values"),s=c.columns.getItem("Cost").getDataBodyRange().load("values"),e.next=8,t.sync();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){var n=s.values.reduce((function(t,n,r){return C(o.values[r][0])===e&&(t+=s.values[r][0]),t}),0),r=t-n,a=!1;return r<0&&(a=!0),[n=n.toFixed(2),r=r.toFixed(2),a]}var R=null;function A(e){i=e,Office.context.ui.displayDialogAsync("https://localhost:3000/error.html",{height:45,width:55},(function(e){(R=e.value).addEventHandler(Office.EventType.DialogMessageReceived,I)}))}function I(e){"connected"===e.message&&R.messageChild(JSON.stringify(i))}function E(e,t,n,r){return S.apply(this,arguments)}function S(){return(S=r(regeneratorRuntime.mark((function e(t,n,r,o){var s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.height=155,n.width=360,n.name=o+"_"+a,n.title.text=r+" Spending in "+a,n.title.format.font.size=16,n.title.format.font.color="#000000",n.legend.position="bottom",n.legend.format.font.size=10,n.legend.format.font.color="#000000",n.axes.valueAxis.format.font.size=10,n.axes.valueAxis.format.font.color="#000000",n.axes.valueAxis.numberFormat="$0.00",n.axes.valueAxis.minimum=0,n.axes.categoryAxis.visible=!1,n.series.load("items"),e.next=17,t.sync();case 17:for(s=0;s<n.series.items.length;s++)(i=n.series.items[s]).gapWidth=0,i.dataLabels.showValue=!0,i.dataLabels.numberFormat="$0.00",i.dataLabels.format.font.size=12,i.dataLabels.format.font.color="#000000";return e.next=20,t.sync();case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t,n,r,a){return B.apply(this,arguments)}function B(){return(B=r(regeneratorRuntime.mark((function e(t,n,r,a,o){var s,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.axes.valueAxis.maximum=o?Math.ceil(a):r,n.axes.valueAxis.majorUnit=r||Math.ceil(a),n.series.load("items","items/name"),e.next=5,t.sync();case 5:for(s=0;s<n.series.items.length;s++)i=n.series.items[s],o&&"Spent"===i.name?i.format.fill.setSolidColor("#FF0000"):"Spent"===i.name?i.format.fill.setSolidColor("#0070C0"):i.format.fill.setSolidColor("#00B050");return e.next=8,t.sync();case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return e.replace(/[^A-Za-z0-9]/g,"")}var D=null;function j(){Office.context.ui.displayDialogAsync("https://localhost:3000/chart.html",{height:45,width:55},(function(e){(D=e.value).addEventHandler(Office.EventType.DialogMessageReceived,_)}))}function _(e){"connected"===e.message&&D.messageChild(JSON.stringify(u))}}();
//# sourceMappingURL=taskpane.js.map